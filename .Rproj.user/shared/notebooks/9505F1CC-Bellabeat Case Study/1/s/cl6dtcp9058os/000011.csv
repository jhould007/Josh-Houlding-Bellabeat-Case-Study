"0","library(dplyr)"
"0","library(ggplot2)"
"0",""
"0","# Filter out rows with 0 steps"
"0","filtered_data <- dailyActivity %>%"
"0","  filter(TotalSteps > 0)"
"0",""
"0","# Group data by date and count the number of unique users"
"0","step_counts_by_date <- filtered_data %>%"
"0","  group_by(ActivityDate) %>%"
"0","  summarise(num_users = n_distinct(Id))"
"0",""
"0","# Find what % of the time people were wearing their Fitbits overall"
"0","avg_users_per_day <- sum(step_counts_by_date$num_users)/31"
"0","overall_percent <- (avg_users_per_day/31)*100 "
"0","print(overall_percent)"
"1","[1]"
"1"," 89.80229"
"1","
"
"0","# Create the bar plot"
"0","ggplot(step_counts_by_date, aes(x = reorder(ActivityDate, num_users))) +"
"0","  geom_bar(mapping=aes(y=num_users), stat = ""identity"", fill = ""blue"", alpha = 0.7) + "
"0","  annotate(geom=""label"", 12, 12, label=""On average, 89.8% of users "
"0","           wore their Fitbits on any given day."", fill=""white"") +"
"0","  labs(title = ""Number of Users who wore their Fitbit on each day"","
"0","       x = ""Date"","
"0","       y = ""Number of Users"") +"
"0","  theme(axis.text.x = element_text(angle = 90))"
